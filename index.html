<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®åœ‹/æ˜“ä¸åœ°æ”¿ - å°ˆæ¥­å ±åƒ¹ç³»çµ±</title>
    <style>
        :root {
            --primary-color: #c8102e;
            --secondary-color: #005a87;
            --gray-text: #555;
            --bg-color: #f0f2f5;
        }

        body {
            font-family: "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            overflow: hidden; /* é˜²æ­¢æ•´é«”æ²è»¸ï¼Œç”±å…§éƒ¨å€å¡Šè™•ç† */
        }

        /* --- å·¦å´æ§åˆ¶é¢æ¿ --- */
        .control-panel {
            width: 400px;
            min-width: 320px;
            background: white;
            padding: 20px;
            border-right: 1px solid #ddd;
            overflow-y: auto; /* ç¨ç«‹æ²è»¸ */
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            z-index: 10;
            display: flex;
            flex-direction: column;
            /* è®“åº•éƒ¨ä¸è¢«åˆ‡æ‰ */
            padding-bottom: 50px; 
        }

        .control-panel h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            font-size: 1.5rem;
        }

        .section-title {
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-weight: bold;
            margin: 20px 0 10px 0;
            text-transform: uppercase;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }

        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9rem; color: #333; }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1rem;
        }

        .btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            font-size: 1rem;
            font-weight: bold;
            transition: 0.3s;
        }
        .btn:hover { background-color: #004466; }
        .btn-green { background-color: #28a745; margin-top: 5px;}
        .btn-red { background-color: #dc3545; width: auto; padding: 8px 12px; font-size: 0.9rem;}

        .item-row {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        .item-row input[type="text"] { flex: 2; min-width: 150px; }
        .item-row input[type="number"] { flex: 1; min-width: 60px; }
        
        /* --- å³å´é è¦½å€ --- */
        .preview-container {
            flex: 1;
            background: #525659;
            padding: 40px;
            overflow: auto; /* å…è¨±æ²å‹• */
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .a4-page {
            background: white;
            width: 210mm;
            /* è®“é«˜åº¦éš¨å…§å®¹å»¶ä¼¸ï¼Œä½†æœ€å°‘ç‚º A4 é«˜åº¦ */
            min-height: 297mm; 
            padding: 15mm 20mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            box-sizing: border-box;
            position: relative;
        }

        /* --- å ±åƒ¹å–®æ’ç‰ˆ --- */
        .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; border-bottom: 3px solid var(--secondary-color); padding-bottom: 15px; }
        .logos { display: flex; gap: 15px; align-items: center; }
        .logos img { height: 60px; object-fit: contain; }
        .company-info { text-align: right; font-size: 12px; color: var(--gray-text); line-height: 1.4; }
        .company-info h1 { margin: 0 0 5px 0; color: #333; font-size: 16px; font-weight: 800; }
        
        .quote-title { text-align: center; font-size: 24px; font-weight: bold; margin: 20px 0; letter-spacing: 3px; color: #222; }

        .info-grid { display: flex; justify-content: space-between; margin-bottom: 30px; gap: 20px; flex-wrap: wrap; }
        .client-info, .meta-info { width: 48%; min-width: 250px; }
        .info-row { display: flex; margin-bottom: 8px; border-bottom: 1px solid #f0f0f0; padding-bottom: 2px; }
        .info-label { width: 85px; font-weight: bold; color: #444; font-size: 14px; }
        .info-value { flex: 1; color: #000; font-size: 14px; word-break: break-all; }

        table.quote-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        table.quote-table th { background-color: var(--secondary-color); color: white; padding: 8px 10px; text-align: left; font-size: 14px; border: 1px solid var(--secondary-color); }
        table.quote-table td { padding: 8px 10px; border: 1px solid #ddd; color: #333; font-size: 14px; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        .totals-section { width: 50%; margin-left: auto; min-width: 200px; }
        .total-row { display: flex; justify-content: space-between; padding: 6px 10px; font-size: 14px; }
        .total-row.final { background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #333; font-size: 16px; margin-top: 10px; padding: 10px; }

        .notes-section { margin-top: 30px; padding: 15px; border: 1px solid #eee; border-left: 5px solid var(--primary-color); background-color: #fffbfc; font-size: 13px; line-height: 1.6; white-space: pre-wrap; text-align: left; }
        
        .signature-section { margin-top: 60px; display: flex; justify-content: space-between; page-break-inside: avoid; }
        .sig-box { width: 40%; border-top: 1px solid #333; padding-top: 10px; text-align: center; font-size: 14px; }

        /* --- æ‰‹æ©Ÿ/å¹³æ¿ RWD èª¿æ•´ --- */
        @media screen and (max-width: 900px) {
            body { flex-direction: column; overflow: auto; height: auto; }
            
            .control-panel { 
                width: 100%; 
                border-right: none; 
                border-bottom: 1px solid #ddd; 
                padding-bottom: 30px;
            }

            .preview-container {
                width: 100%;
                padding: 10px;
                background: #e0e0e0;
                display: block; /* è®“å…§å®¹å¯æ»‘å‹• */
                overflow-x: auto; /* å…è¨±æ©«å‘æ²å‹•æŸ¥çœ‹å ±åƒ¹å–® */
            }

            .a4-page {
                margin: 0 auto; /* å±…ä¸­ */
                /* åœ¨æ‰‹æ©Ÿä¸Šä¿æŒ A4 å¯¬åº¦ï¼Œè®“ä½¿ç”¨è€…æ»‘å‹•æŸ¥çœ‹ï¼Œé¿å…æ“ å£“è®Šå½¢ */
                min-width: 210mm; 
            }
        }

        /* --- åˆ—å°æ¨¡å¼ --- */
        @media print {
            body { display: block; background: white; height: auto; overflow: visible; }
            .control-panel { display: none; }
            .preview-container { display: block; padding: 0; background: white; margin: 0; width: 100%; overflow: visible; }
            .a4-page { width: 100%; box-shadow: none; padding: 0; margin: 0; min-height: 0; min-width: 0; border: none; }
            @page { margin: 10mm 15mm; }
        }
    </style>
</head>
<body oncontextmenu="return false;"> 
<div class="control-panel">
        <h2>ğŸ”’ å®åœ‹/æ˜“ä¸ å ±åƒ¹ç³»çµ±</h2>
        <div style="font-size:12px; color:#888; margin-bottom:10px;">å®‰å…¨æ¨¡å¼ï¼šå·²å•Ÿç”¨é˜²æ‹·è²ä¿è­·</div>
        
        <div class="section-title">åŸºæœ¬è³‡è¨Š</div>
        <div class="form-group">
            <label>å°ˆæ¡ˆåç¨± / å–®è™Ÿ</label>
            <!-- ä¿®æ”¹ï¼šå°‡é è¨­å€¼æ¸…ç©º -->
            <input type="text" id="inputSubject" value="" placeholder="è«‹è¼¸å…¥å°ˆæ¡ˆåç¨±" oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>å ±åƒ¹æ—¥æœŸ</label>
            <input type="date" id="inputDate" oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>æœ‰æ•ˆæœŸé™</label>
            <input type="date" id="inputValidDate" oninput="updatePreview()">
        </div>

        <div class="section-title">æˆ‘æ–¹è³‡è¨Š</div>
        <div class="form-group">
            <label>å…¬å¸åœ°å€</label>
            <input type="text" id="inputCompanyAddress" value="å°å—å¸‚åŒ—å€æ–‡è³¢è·¯1080å··11è™Ÿ" oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>è¯çµ¡çª—å£</label>
            <!-- ä¿®æ”¹ï¼šå°‡é è¨­å€¼æ”¹ç‚º æ¥Šç¿Šæ™Ÿåœ°æ”¿å£« -->
            <input type="text" id="inputContact" value="æ¥Šç¿Šæ™Ÿåœ°æ”¿å£«" oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>è¯çµ¡é›»è©±</label>
            <input type="text" id="inputPhone" value="0912-584-498" oninput="updatePreview()">
        </div>

        <div class="section-title">å®¢æˆ¶è³‡è¨Š</div>
        <div class="form-group">
            <label>å®¢æˆ¶åç¨±</label>
            <!-- ä¿®æ”¹ï¼šå°‡é è¨­å€¼æ¸…ç©ºï¼Œæ–¹ä¾¿è¼¸å…¥æ–°å®¢æˆ¶ -->
            <input type="text" id="inputClient" value="" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åç¨±" oninput="updatePreview()">
        </div>
        <div class="form-group">
            <label>å®¢æˆ¶åœ°å€</label>
            <input type="text" id="inputClientAddress" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åœ°å€" oninput="updatePreview()">
        </div>

        <div class="section-title">é …ç›®åˆ—è¡¨</div>
        <div id="itemsContainer"></div>
        <button class="btn btn-green" onclick="addItem()">+ æ–°å¢é …ç›®</button>

        <div class="section-title">çµç®—èˆ‡å‚™è¨»</div>
        <div class="form-group">
            <label>æŠ˜æ‰£é‡‘é¡</label>
            <!-- ä¿®æ”¹ï¼šé è¨­æ­¸é›¶ -->
            <input type="number" id="inputDiscount" value="0" oninput="calculateTotal()">
        </div>

        <div class="form-group">
            <label>å‚™è¨»æ¢æ¬¾</label>
            <!-- ä¿®æ”¹ï¼šç§»é™¤ç‰¹å®šé‡‘é¡çš„èªªæ˜ï¼Œæ”¹ç‚ºé€šç”¨æ¨¡æ¿ -->
            <textarea id="inputNotes" rows="6" oninput="updatePreview()">æ­¤ææ¡ˆåŒ…æ‹¬ä¸‹è¿°æ¢ä»¶:
1. è©²å ±åƒ¹ä¸å«æ”¿åºœå–®ä½æ‰€æ”¶å–ä¹‹ç¨…é‡‘ï¼Œç”±å»ºè¨­å…¬å¸è² æ“”ä¹‹è²»ç”¨ï¼Œä¸¦é…åˆå»ºè¨­å…¬å¸åˆ†æ‰¹äº¤å±‹æ™‚è«‹æ¬¾ã€‚
2. åŒ¯æ¬¾è³‡è¨Šï¼š(è«‹åœ¨æ­¤è¼¸å…¥éŠ€è¡Œå¸³è™Ÿ)</textarea>
        </div>

        <button class="btn" onclick="window.print()">ğŸ–¨ï¸ åˆ—å° / ä¸‹è¼‰ PDF</button>
    </div>

    <div class="preview-container">
        <div class="a4-page">
            
            <div class="header">
                <div class="logos">
                    <img src="å®åœ‹åœ°æ”¿å°é¢.jpg" alt="å®åœ‹" onerror="this.style.display='none'; document.getElementById('logo-text-hg').style.display='block'">
                    <img src="æœªå‘½å2.png" alt="æ˜“ä¸" onerror="this.style.display='none'; document.getElementById('logo-text-yc').style.display='block'">
                    
                    <div id="logo-text-hg" style="display:none; font-weight:bold; color:#c8102e; font-size:20px;">HG å®åœ‹åœ°æ”¿</div>
                    <div id="logo-text-yc" style="display:none; font-weight:bold; color:#005a87; font-size:20px; margin-left:10px;">æ˜“ä¸åœ°æ”¿å£«äº‹å‹™æ‰€</div>
                </div>
                <div class="company-info">
                    <h1>å®åœ‹åœ°æ”¿å£«äº‹å‹™æ‰€ | æ˜“ä¸åœ°æ”¿å£«äº‹å‹™æ‰€</h1>
                    <div id="displayCompanyAddress">å°å—å¸‚åŒ—å€æ–‡è³¢è·¯1080å··11è™Ÿ</div>
                    <div>TEL: 06-258-2589 | FAX: 06-250-3839</div>
                    <div>E-MAIL: homegoestate@gmail.com</div>
                </div>
            </div>

            <div class="quote-title">å ± åƒ¹ å–® (QUOTATION)</div>

            <div class="info-grid">
                <div class="client-info">
                    <div class="info-row"><div class="info-label">å®¢æˆ¶åç¨±ï¼š</div><div class="info-value" id="displayClient"></div></div>
                    <div class="info-row"><div class="info-label">å®¢æˆ¶åœ°å€ï¼š</div><div class="info-value" id="displayClientAddress"></div></div>
                    <div class="info-row"><div class="info-label">å°ˆæ¡ˆåç¨±ï¼š</div><div class="info-value" id="displaySubject"></div></div>
                </div>
                <div class="meta-info">
                    <div class="info-row"><div class="info-label">å ±åƒ¹æ—¥æœŸï¼š</div><div class="info-value" id="displayDate"></div></div>
                    <div class="info-row"><div class="info-label">æœ‰æ•ˆæœŸé™ï¼š</div><div class="info-value" id="displayValidDate"></div></div>
                    <div class="info-row"><div class="info-label">è¯çµ¡çª—å£ï¼š</div><div class="info-value"><span id="displayContact"></span> (<span id="displayPhone"></span>)</div></div>
                </div>
            </div>

            <table class="quote-table">
                <thead>
                    <tr>
                        <th style="width: 45%">é …ç›® / æè¿°</th>
                        <th class="text-center" style="width: 10%">æ•¸é‡</th>
                        <th class="text-right" style="width: 20%">å–®åƒ¹</th>
                        <th class="text-right" style="width: 25%">é‡‘é¡</th>
                    </tr>
                </thead>
                <tbody id="displayItems"></tbody>
            </table>

            <div class="totals-section">
                <div class="total-row"><span>å°è¨ˆ (Subtotal):</span><span id="displaySubtotal">NT$0</span></div>
                <div class="total-row"><span>ç¨…é‡‘ (Tax 0%):</span><span>NT$0</span></div>
                <div class="total-row" style="color: var(--primary-color);"><span>æŠ˜æ‰£ (Discount):</span><span id="displayDiscount">-NT$0</span></div>
                <div class="total-row final"><span>ç¸½è¨ˆ (Total):</span><span id="displayTotal">NT$0</span></div>
            </div>

            <div class="notes-section">
                <strong>å‚™è¨»äº‹é …ï¼š</strong><br>
                <span id="displayNotes"></span>
            </div>

            <div class="signature-section">
                <div class="sig-box">å®¢æˆ¶ç°½ç½² (Acceptance)<br><br><br></div>
                <div class="sig-box">å…¬å¸æˆæ¬Šä»£è¡¨ (Authorized)<br><br><br></div>
            </div>

        </div>
    </div>

    <script>
        /* === å®‰å…¨é˜²è­·è…³æœ¬ === */
        document.onkeydown = function(e) {
            // é˜»æ“‹ F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            if(event.keyCode == 123) { return false; }
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) { return false; }
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) { return false; }
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) { return false; }
        }

        /* === å ±åƒ¹å–®é‚è¼¯ === */
        // è‡ªå‹•å¸¶å…¥ä»Šå¤©æ—¥æœŸèˆ‡ä¸‹å€‹æœˆåº•
        document.getElementById('inputDate').valueAsDate = new Date();
        let d = new Date();
        document.getElementById('inputValidDate').valueAsDate = new Date(d.getFullYear(), d.getMonth() + 1, 0);

        // ä¿®æ”¹ï¼šé è¨­ç‚ºç©ºé …ç›®ï¼Œè€Œéç‰¹å®šå»ºæ¡ˆ
        let items = [{ desc: '', qty: 1, price: 0 }];

        function renderInputItems() {
            const container = document.getElementById('itemsContainer');
            container.innerHTML = '';
            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'item-row';
                div.innerHTML = `
                    <input type="text" placeholder="å“é …" value="${item.desc}" oninput="updateItem(${index}, 'desc', this.value)">
                    <input type="number" placeholder="æ•¸" value="${item.qty}" oninput="updateItem(${index}, 'qty', this.value)">
                    <input type="number" placeholder="åƒ¹" value="${item.price}" oninput="updateItem(${index}, 'price', this.value)">
                    <button class="btn btn-red" onclick="removeItem(${index})">X</button>
                `;
                container.appendChild(div);
            });
            updatePreview();
        }

        function addItem() { items.push({ desc: '', qty: 1, price: 0 }); renderInputItems(); }
        function removeItem(index) { items.splice(index, 1); renderInputItems(); }
        function updateItem(index, field, value) {
            items[index][field] = (field === 'qty' || field === 'price') ? (parseFloat(value) || 0) : value;
            calculateTotal();
        }

        function formatMoney(amount) {
            return 'NT$' + amount.toFixed(0).replace(/\d(?=(\d{3})+$)/g, '$&,');
        }

        function calculateTotal() {
            let subtotal = 0;
            const tbody = document.getElementById('displayItems');
            tbody.innerHTML = '';
            items.forEach(item => {
                const amount = item.qty * item.price;
                subtotal += amount;
                tbody.innerHTML += `<tr><td>${item.desc}</td><td class="text-center">${item.qty}</td><td class="text-right">${formatMoney(item.price)}</td><td class="text-right">${formatMoney(amount)}</td></tr>`;
            });
            const discount = parseFloat(document.getElementById('inputDiscount').value) || 0;
            document.getElementById('displaySubtotal').innerText = formatMoney(subtotal);
            document.getElementById('displayDiscount').innerText = '-' + formatMoney(discount);
            document.getElementById('displayTotal').innerText = formatMoney(subtotal - discount);
        }

        function updatePreview() {
            const ids = ['Subject', 'Client', 'ClientAddress', 'Date', 'ValidDate', 'Notes', 'Contact', 'Phone', 'CompanyAddress'];
            ids.forEach(id => {
                const el = document.getElementById('display' + id);
                const input = document.getElementById('input' + id);
                if(el && input) el.innerText = input.value;
            });
            calculateTotal();
        }
        renderInputItems();
    </script>
<!-- Chosen Palette: Existing Red/Blue Professional -->
<!-- Application Structure Plan: Split view quotation editor with live preview. Left side controls input, right side displays A4 print preview. -->
<!-- Visualization & Content Choices: HTML Table for line items, real-time JS calculation for totals. No SVG graphics used. NO Mermaid JS used. -->
<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</body>
</html>